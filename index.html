<!DOCTYPE html>
<html>
<head>
  <title>APRP RP Time System</title>
  <style>
    body { font-family: sans-serif; text-align: center; margin-top: 10vh; }
    h1 { font-size: 2em; }
    .big { font-size: 1.6em; margin: 20px; }
    input, button { font-size: 1em; padding: 8px; margin: 5px; }
  </style>
</head>
<body>

<h1>APRP Time Information</h1>

<div class="big">
  <strong>Current RP Time:</strong><br>
  <span id="rpNow"></span>
</div>

<hr style="width:60%; margin:30px auto;">

<h2>Convert IRL → RP</h2>

<input type="datetime-local" id="irlInput">
<button onclick="convertTime()">Convert</button>

<div class="big" id="convertedRP"></div>

<hr style="width:60%; margin:30px auto;">

<div class="big">
  <strong>Made by Ameilka Sulewska <3 </strong><br>
  <strong>
    <a href="https://discord.gg/mockgov">Join the APRP Discord</a>
  </strong>
</div>

<script>
// Configuration
const START_RP = {
  year: 2002,
  month: 9,   // September
  day: 30,
  hour: 18,
  minute: 0,
  second: 0
};

const MONTHS_PER_IRL_DAY = 1.20;   // ← your acceleration rate

// Helper: create UTC Date from components
function makeUTCDate(y, m, d, hh = 0, mm = 0, ss = 0) {
  return new Date(Date.UTC(y, m - 1, d, hh, mm, ss));
}

function irlToRP(irlDate) {
  const irlUTC = new Date(irlDate.getTime() + irlDate.getTimezoneOffset() * 60000);
  const start = makeUTCDate(
    START_RP.year,
    START_RP.month,
    START_RP.day,
    START_RP.hour,
    START_RP.minute,
    START_RP.second
  );

  const msDiff = irlUTC - start;
  if (msDiff < 0) return start; // before start → return start time

  const daysPassed = msDiff / (86400 * 1000);
  const totalRPMonths = daysPassed * MONTHS_PER_IRL_DAY;

  let months = Math.floor(totalRPMonths);
  let fracMonth = totalRPMonths - months;

  // Add whole months
  let rpYear  = START_RP.year;
  let rpMonth = START_RP.month; // 1–12

  months += (rpMonth - 1);           // now months since Jan year 0-ish
  rpYear  += Math.floor(months / 12);
  rpMonth  = (months % 12) + 1;      // back to 1–12

  // Now handle fractional month → days + time
  const daysInCurrentMonth = new Date(Date.UTC(rpYear, rpMonth, 0)).getUTCDate(); // last day of month

  // Most intuitive: start from day 1, add fraction
  let extraDays = fracMonth * daysInCurrentMonth;
  let rpDay = 1 + Math.floor(extraDays);
  let fracDay = extraDays - Math.floor(extraDays);

  // Carry over days if needed
  while (rpDay > daysInCurrentMonth) {
    rpDay -= daysInCurrentMonth;
    rpMonth++;
    if (rpMonth > 12) {
      rpMonth = 1;
      rpYear++;
    }
    // Recalculate days in new month
    daysInCurrentMonth = new Date(Date.UTC(rpYear, rpMonth, 0)).getUTCDate();
  }

  // Time portion
  const secondsInDay = fracDay * 86400;
  const rpHour   = Math.floor(secondsInDay / 3600);
  const rpMinute = Math.floor((secondsInDay % 3600) / 60);
  const rpSecond = Math.floor(secondsInDay % 60);

  return makeUTCDate(rpYear, rpMonth, rpDay, rpHour, rpMinute, rpSecond);
}

function formatRP(date) {
  const days = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];
  const months = ['January','February','March','April','May','June','July','August','September','October','November','December'];

  const dayName   = days[date.getUTCDay()];
  const monthName = months[date.getUTCMonth()];
  const dayNum    = date.getUTCDate();
  const year      = date.getUTCFullYear();

  let h = date.getUTCHours();
  const m = date.getUTCMinutes().toString().padStart(2, '0');
  const ampm = h >= 12 ? 'PM' : 'AM';
  h = h % 12 || 12;

  return `${dayName}, ${monthName} ${dayNum}, ${year} at ${h}:${m} ${ampm}`;
}

// Live clock
function updateClock() {
  const rp = irlToRP(new Date());
  document.getElementById("rpNow").innerText = formatRP(rp);
}

setInterval(updateClock, 1000);
updateClock();

// Manual convert
function convertTime() {
  const val = document.getElementById("irlInput").value;
  if (!val) return;

  const inputDate = new Date(val);
  if (isNaN(inputDate)) {
    document.getElementById("convertedRP").innerText = "Invalid date";
    return;
  }

  const rp = irlToRP(inputDate);
  document.getElementById("convertedRP").innerText = "RP Time: " + formatRP(rp);
}
</script>

</body>
</html>
